---
title: Oracle-RAC体系结构
date: 2018-05-26 17:45:54
categories:
- 数据库
tags:
---
系统故障转移共有3种一般方法。按照可用性的升高顺序，依次为无故障转移、冷故障转移和热故障转移。  

Oracle RAC在本质上是为多台服务器提供对同一数据副本进行一致性访问的能力。  

尽管Oracle RAC能够很好地进行伸缩，但水平可伸缩性也有一个上限。一般来说，应用程序的可伸缩性取决于这个应用程序在单个实例上的工作状况。如果这个应用程序执行的SQL语言是高效的，使用的资源数量合理，那么通常可以认为它能很好地伸缩，相反，它还会使问题放大，使情况变得更糟。这一点也适用于Oracle RAC或任意其他可伸缩性解决方案。因此，在使用集群进行扩展之前，需要确保进行了应用程序级别的调优以清除瓶颈。  

Oracle RAC允许多个实例访问同一个数据库，从Oracle 11g R2开始，Oracle集群件栈被称为"Oracle Grid Infrastructure"。  

Oracle RAC的主要组件包括：  

共享磁盘系统，Oracle集群件，集群互联，Oracle内核组件  

可伸缩共享存储是Oracle RAC环境中的一个关键组件。传统上，使用主机本地的SCSI或SATA接口将存储设备连接到各个服务器。今天，更灵活的存储设备已经很流行了，可以使用常规的以太网，通过存储区域网络(SAN)或网络连接存储(NAS)来访问。这些新的存储选项使多台服务器能够通过一个网络访问同一组磁盘，简化了在任意分布式环境中提供存储的过程。  

在共享存储中，数据库文件应当能提供所有节点平等地并发访问。一般的文件系统不允许在一个以上的系统中安装磁盘。依赖于单一节点，而且这个节点可能成为单一故障点(SPOF),所以它是对高可用性(HA)体系结构的另一个威胁。  

主要有3种方法可以提供RAC所需要的共享存储：
1. 原始卷
2. 集群文件系统
3. 自动存储管理(ASM)：ASM是为Oracle数据库文件准备的一种可移植、专用、优化的集群文件系统。


"Oracle集群件"是可移植软件。它由几个后台进程组成，这些进程执行不同的功能，用以推动集群操作。  

Oracle集群件由集群就绪服务(CRS)使用"Oracle集群注册表"和表决磁盘进行管理，OCR记录和维持集群及节点的成员资格信息，表决器在通信故障时充当一个仲裁者。在集群运行期间，来自所有节点的一致性心跳信息都会发送给表决磁盘。  

构成Oracle集群件的后台进程和服务是CRSd(CRS守护进程)、OCSSd(Oracle集群同步服务守护进程)、OPROCd(进程监控器守护进程，在11g R2版本中废弃)、EVMd(事件卷管理器守护进程)和ONS(Oracle通知服务)。  

Oracle 10g引入了一个名为"集群VIP"的新功能，集群VIP就是一个集群虚拟IP地址，外部世界将使用这个IP地址连接到数据库。这个IP地址应当不同于集群中的IP地址集。  

应用程序VIP是一种用于管理网络IP地址的集群资源。如果一个应用程序依赖于应用程序VIP(AVIP)，只要有一个节点停机，应用程序VIP就会故障转移到仍在正常运行的节点，并在这个节点上重新启动此应用程序进程。
