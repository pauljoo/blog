---
title: Java-运行时数据区
date: 2018-11-16 20:04:09
categories:
- Java
tags:
---

- 程序计数器

每个线程都有独立的程序计数器，用于记录当前线程所执行的字节码的行号指示器。

- Java虚拟机栈

线程私有。每个方法在执行的同时都会创建一个栈帧用于存储局部变量表、操作数栈、动态链接、方法出口等信息。每一个方法从调用直至执行完成的过程，对应一个栈帧在虚拟机栈中入栈到出栈的过程。
局部变量表存放了编译期可知的各种基本数据类型、对象引用类型和returnAddress类型。
-Xss

- 本地方法栈

虚拟机使用的Native方法的栈空间。

- Java堆

所有线程共享的一块内存区域。垃圾收集器管理的主要区域。
相关JVM启动参数：`-Xmx, -Xms`

- 方法区

所有线程共享的一块内存区域。存储虚拟机加载的类信息、常量、静态变量、即时编译器编译后的代码等数据。
相关JVM启动参数：
```
//（JDK7）方法区主要存储类的相关信息，所以对于动态生成类的情况比较容易出现永久代的内存溢出
-XX: PermSize=128m -XX:MaxPermSize=512m

//元空间并不在虚拟机中，而是使用本地内存。默认情况下，元空间的大小仅受本地内存限制。
-XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=512m

//JIT编译后二进制代码的存放区，满了之后就不再编译，对性能影响很大
-XX:ReservedCodeCacheSize
```

- 运行时常量池

方法区的一部分。用于存放编译期生成的各种字面量和符号引用。

- 直接内存

使用Native函数库直接分配堆外内存，不受Java堆大小的限制。
相关JVM启动参数：`-XX:MaxDirectMemorySize`